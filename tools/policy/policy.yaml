policyVersion: "0.1"
defaults:
  mode: enforce
  response:
    blockStatusCode: 403
routes:
  - id: license.activate.v1
    match: { method: POST, path: /api/license/activate }
    contract:
      rejectUnknownFields: true
    rules:
      - id: auth.required
        type: cel
        action: block
        severity: high
        config:
          expr: identity.authenticated == true

      - id: tenant.binding
        type: cel
        action: block
        severity: critical
        config:
          expr: identity.tenant == request.body.tenantId
