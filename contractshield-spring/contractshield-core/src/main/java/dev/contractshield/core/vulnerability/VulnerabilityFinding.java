package dev.contractshield.core.vulnerability;

/**
 * Represents a detected vulnerability in request data.
 *
 * @param type the type of vulnerability
 * @param severity the severity level
 * @param path JSON path where vulnerability was found
 * @param value the suspicious value (truncated for safety)
 * @param message descriptive message
 */
public record VulnerabilityFinding(
        VulnerabilityType type,
        Severity severity,
        String path,
        String value,
        String message
) {
    /**
     * Create a finding with truncated value.
     */
    public static VulnerabilityFinding of(
            VulnerabilityType type,
            Severity severity,
            String path,
            String value,
            String message) {
        // Truncate value for safety
        String truncated = value != null && value.length() > 100
                ? value.substring(0, 100) + "..."
                : value;
        return new VulnerabilityFinding(type, severity, path, truncated, message);
    }
}
