package dev.contractshield.spring.test;

import java.util.Map;

/**
 * Test request payloads for vulnerability testing.
 * These payloads can be used to verify that ContractShield correctly
 * detects and blocks malicious inputs.
 */
public final class VulnerabilityTestRequests {

    private VulnerabilityTestRequests() {
        // Utility class
    }

    /**
     * SQL injection test payloads.
     */
    public static final class SQLi {
        public static final String UNION_SELECT = "' UNION SELECT * FROM users --";
        public static final String OR_1_EQUALS_1 = "' OR '1'='1";
        public static final String SEMICOLON_DROP = "'; DROP TABLE users; --";
        public static final String COMMENT_BYPASS = "admin'--";

        public static Map<String, Object> payload(String field) {
            return Map.of(field, UNION_SELECT);
        }
    }

    /**
     * XSS test payloads.
     */
    public static final class XSS {
        public static final String SCRIPT_ALERT = "<script>alert('xss')</script>";
        public static final String IMG_ONERROR = "<img src=x onerror=alert('xss')>";
        public static final String EVENT_HANDLER = "<body onload=alert('xss')>";
        public static final String JAVASCRIPT_URL = "javascript:alert('xss')";

        public static Map<String, Object> payload(String field) {
            return Map.of(field, SCRIPT_ALERT);
        }
    }

    /**
     * Path traversal test payloads.
     */
    public static final class PathTraversal {
        public static final String UNIX_PASSWD = "../../../etc/passwd";
        public static final String WINDOWS_HOSTS = "..\\..\\..\\windows\\system32\\drivers\\etc\\hosts";
        public static final String URL_ENCODED = "..%2F..%2F..%2Fetc%2Fpasswd";

        public static Map<String, Object> payload(String field) {
            return Map.of(field, UNIX_PASSWD);
        }
    }

    /**
     * Prototype pollution test payloads.
     */
    public static final class PrototypePollution {
        public static final String PROTO = "__proto__";
        public static final String CONSTRUCTOR = "constructor";
        public static final String PROTOTYPE = "prototype";

        public static Map<String, Object> payload() {
            return Map.of("__proto__", Map.of("polluted", true));
        }
    }
}
